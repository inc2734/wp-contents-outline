!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ContentsOutline=t()}(this,function(){"use strict";const l=(e,t)=>{const n=[];return[].slice.call(e).forEach(e=>{e=new r(e,t);e&&n.push(e)}),n},c=(r,e)=>{if("true"!==r.getAttribute("data-initialized")){const t=r.querySelector(".contents-outline");if(t)if(e.headings.length<1)r.parentNode.removeChild(r);else{e.headings.sort((e,t)=>{return e.getBoundingClientRect().top-t.getBoundingClientRect().top});const c=(e,t)=>{return document.getElementById(`${e}${t}`)?c(e,t+1):t};let n=0;[].slice.call(e.headings).forEach(e=>{var t;e.getAttribute("id")||(t=n,t=c("co-index-",t),e.setAttribute("id",`co-index-${t}`),n=t+1)});const s=e=>e?parseInt(e.tagName.replace("H","")):void 0;let i=0,o=void 0,l=[{level:void 0,tree:document.createElement("ol")}];const d=e=>{const t=document.createElement("li"),n=document.createElement("a");return n.textContent=e.textContent.replace(/[\n\r]/g,""),n.setAttribute("href",`#${e.getAttribute("id")}`),t.appendChild(n),t},a=e=>{const t=document.createElement("ol");return t.appendChild(d(e)),t},u=e=>{var t=s(o),n=s(e),r=n<t;t<n?i++:r&&(i=i-t-n,i=i<0?0:i,i=l[i].level<n?i+1:i,n=l[0],l=[],l[0]=n),(e=>{if(l[i])l[i].tree.appendChild(d(e));else{l[i]={},l[i].tree=a(e);const t=[].slice.call(l[i-1].tree.children).slice(-1)[0];t.appendChild(l[i].tree)}l[i].level=s(e)})(e),o=e};if([].slice.call(e.headings).forEach(e=>u(e)),!0===e.moveToBefore1stHeading){const f=e.headings[0];f.parentNode.insertBefore(r,f)}if("function"==typeof IntersectionObserver){const h=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=r.querySelector('[data-is-current="true"]');t&&t.removeAttribute("data-is-current");const n=r.querySelector(`a[href='#${e.target.id}']`);n&&n.parentElement.setAttribute("data-is-current","true")}})},{root:null,rootMargin:"-50% 0px",threshold:0});[].slice.call(e.headings).forEach(e=>{h.observe(e)})}t.appendChild(l[0].tree),r.setAttribute("aria-hidden","false"),r.setAttribute("data-initialized","true")}}};function r(e,t={}){var n={headings:document.querySelectorAll("h2, h3, h4, h5, h6"),moveToBefore1stHeading:!0};const r={};for(const o in n)r[o]=(void 0!==t[o]?t:n)[o];if("string"!=typeof e)return!0==e instanceof NodeList?l(e,r):!0==e instanceof HTMLElement?c(e,r):void 0;if(e.match(/^#/)){var i=document.querySelector(e);if(i)return c(i,r)}else{e=document.querySelectorAll(e);if(!(e.length<1))return l(e,r)}}return r});
