!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ContentsOutline=t()}(this,function(){"use strict";const l=(e,t)=>{const n=[];return[].slice.call(e).forEach(e=>{e=new r(e,t);e&&n.push(e)}),n},d=(l,e)=>{if("true"!==l.getAttribute("data-initialized")){const t=l.querySelector(".contents-outline");if(t){const d=e.headings.filter(e=>{let t=e,n=!1,r=!1;for(;;){if(!t.parentNode||["#document","HTML","BODY"].includes(t.parentNode.nodeName))break;if(n="none"===window.getComputedStyle(t.parentNode).getPropertyValue("display"),r="hidden"===window.getComputedStyle(t.parentNode).getPropertyValue("visibility"),n||r)break;t=t.parentNode}return"none"!==window.getComputedStyle(e).getPropertyValue("display")&&"hidden"!==window.getComputedStyle(e).getPropertyValue("visibility")&&!n&&!r});if(d.length<1)l.parentNode.removeChild(l);else{d.sort((e,t)=>{return e.getBoundingClientRect().top-t.getBoundingClientRect().top});const a=(e,t)=>{return document.getElementById(`${e}${t}`)?a(e,t+1):t};let n=0;[].slice.call(d).forEach(e=>{var t;e.getAttribute("id")||(t=n,t=a("co-index-",t),e.setAttribute("id",`co-index-${t}`),n=t+1)});const c=e=>{const t=document.createElement("li"),n=document.createElement("a");return n.textContent=e.textContent.replace(/[\n\r]/g,""),n.setAttribute("href",`#${encodeURI(e.getAttribute("id"))}`),t.appendChild(n),t},s=(e,t)=>{let n="";for(let e=0;e<t;e++)n+=".lastElementChild.lastElementChild";n=n.slice(1);const r=n.split(".");for(;r.length;)e=e[r.shift()];return e},u=(t,e=[])=>{let n;return[].slice.call(e).some(e=>{e=t.parentNode===e;return e&&(n=t),e})?n:t.parentNode?u(t.parentNode,e):t};const f=document.createElement("ol");let r=void 0,o=0,i=!1;if(d.forEach(e=>{var t,t=(t=e)?parseInt(t.tagName.replace("H","")):void 0;t<r?(i||(o=o+t-r),o=o<0?0:o,i=!1):t>r&&(1<t-r&&(i=!0),o++),0===o?f.appendChild(c(e)):0<o&&("OL"!==s(f,o).tagName&&s(f,o).parentElement.appendChild(document.createElement("ol")),s(f,o).appendChild(c(e))),r=t}),!0===e.moveToBefore1stHeading){const p=d[0];e=e?.moveTo;if(e){const movingTarget=(e=>{let t=e;for(;;){var n=t.parentElement;if(!n)break;if(!(1===n.children.length))break;t=n}return t})(l),m=u(p,e);m.parentNode.insertBefore(movingTarget,m)}else p.parentNode.insertBefore(movingTarget,p)}if("function"==typeof IntersectionObserver){const h=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=l.querySelector('[data-is-current="true"]');t&&t.removeAttribute("data-is-current");const n=l.querySelector(`a[href='#${encodeURI(e.target.id)}']`);n&&n.parentElement.setAttribute("data-is-current","true")}})},{root:null,rootMargin:"-50% 0px",threshold:0});[].slice.call(d).forEach(e=>{h.observe(e)})}t.appendChild(f),l.setAttribute("aria-hidden","false"),l.setAttribute("data-initialized","true")}}}};function r(e,t={}){var n={headings:document.querySelectorAll("h2, h3, h4, h5, h6"),moveToBefore1stHeading:!0,moveTo:void 0};const r={};for(const i in n)r[i]=(void 0!==t[i]?t:n)[i];if("string"!=typeof e)return!0==e instanceof NodeList?l(e,r):!0==e instanceof HTMLElement?d(e,r):void 0;if(e.match(/^#/)){var o=document.querySelector(e);if(o)return d(o,r)}else{e=document.querySelectorAll(e);if(!(e.length<1))return l(e,r)}}return r});
